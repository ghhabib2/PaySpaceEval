<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>
        {% block title %}
        {% endblock %}
    </title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="../files/assets/images/logo/favicon.png">

    <!-- page css -->
    {% block custom_css %}
    {% endblock %}
    <!-- Core css -->
    <link href="../files/assets/css/app.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../files/assets/css/bootoast.min.css" rel="stylesheet" >

</head>

<body>
    <div class="app">
        <div class="layout">
            <!-- Header START -->
            <div class="header">
                <div class="logo logo-dark">
                    <a href="home">
                        <img src="../files/assets/images/logo/logo.png" alt="Logo">
                        <img class="logo-fold" src="files/assets/images/logo/logo-fold.png" alt="Logo">
                    </a>
                </div>
                <div class="logo logo-white">
                    <a href="index.html">
                        <img src="files/assets/images/logo/logo-white.png" alt="Logo">
                        <img class="logo-fold" src="files/assets/images/logo/logo-fold-white.png" alt="Logo">
                    </a>
                </div>
                <div class="nav-wrap">
                    <ul class="nav-left">
                        <li class="desktop-toggle">
                            <a href="javascript:void(0);">
                                <i class="anticon"></i>
                            </a>
                        </li>
                        <li class="mobile-toggle">
                            <a href="javascript:void(0);">
                                <i class="anticon"></i>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" data-toggle="modal" data-target="#search-drawer">
                                <i class="anticon anticon-search"></i>
                            </a>
                        </li>
                    </ul>
                    <ul class="nav-right">

                        <li class="dropdown dropdown-animated scale-left">
                            <div class="pointer" data-toggle="dropdown">
                                <div class="avatar avatar-image  m-h-10 m-r-15">
                                    <img src="files/assets/images/avatars/thumb_fix.png"  alt="">
                                </div>
                            </div>
                            <div class="p-b-15 p-t-20 dropdown-menu pop-profile">
                                <div class="p-h-20 p-b-15 m-b-10 border-bottom">
                                    <div class="d-flex m-r-50">
                                        <div class="avatar avatar-lg avatar-image">
                                            <img src="files/assets/images/avatars/thumb_fix.png" alt="">
                                        </div>
                                        <div class="m-l-10">
                                            <p class="m-b-0 text-dark font-weight-semibold" id="user_info_link"></p>
                                            <p class="m-b-0 opacity-07"></p>
                                        </div>
                                    </div>
                                </div>
                                <a href="#" class="dropdown-item d-block p-h-15 p-v-10" onclick="logOutUser('user_data');">
                                    <div class="d-flex align-items-center justify-content-between">
                                        <div>
                                            <i class="anticon opacity-04 font-size-16 anticon-logout"></i>
                                            <span class="m-l-10">
                                                Logout
                                            </span>
                                        </div>

                                    </div>
                                </a>
                            </div>
                        </li>
                        <li>
                            <a href="javascript:void(0);" data-toggle="modal" data-target="#quick-view">
                                <i class="anticon anticon-appstore"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- Header END -->

            <!-- Side Nav START -->
            <div class="side-nav">
                <div class="side-nav-inner">
                    <ul class="side-nav-menu scrollable">
                        <li class="nav-item dropdown open">
                            <a class="dropdown-toggle" href="home">
                                <span class="icon-holder">
                                    <i class="anticon anticon-dashboard"></i>
                                </span>
                                <span class="title">Dashboard</span>
                            </a>

                        </li>
                        <li class="nav-item dropdown">
                            <a class="dropdown-toggle" href="addresses">
                                <span class="icon-holder">
                                    <i class="anticon anticon-read"></i>
                                </span>
                                <span class="title">Addresses</span>
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="dropdown-toggle" href="inner_outer_transaction">
                                <span class="icon-holder">
                                    <i class="anticon anticon-money-collect"></i>
                                </span>
                                <span class="title">Transaction</span>
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="dropdown-toggle" href="inner_inner_transaction">
                                <span class="icon-holder">
                                    <i class="anticon anticon-property-safety"></i>
                                </span>
                                <span class="title">Inner Transaction</span>
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="dropdown-toggle" href="#" onclick="logOutUser('user_data')">
                                <span class="icon-holder">
                                    <i class="anticon anticon-logout"></i>
                                </span>
                                <span class="title">Logout</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- Side Nav END -->

            <!-- Page Container START -->
            <div class="page-container">
                <!-- Content Wrapper START -->
                <div class="main-content">
                    {% block page_content %}
                    {% endblock %}`
                </div>
                <!-- Footer START -->
                <footer class="footer">
                    <div class="footer-content justify-content-between">
                        <p class="m-b-0">Copyright Â© 2023 PaySpace. All rights reserved.</p>
                        <span>
                            <a href="" class="text-gray m-r-15">Term &amp; Conditions</a>
                            <a href="" class="text-gray">Privacy &amp; Policy</a>
                        </span>
                    </div>
                </footer>
                <!-- Footer END -->

            </div>
            <!-- Page Container END -->

            <!-- Search Start-->
            <div class="modal modal-left fade search" id="search-drawer">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header justify-content-between align-items-center">
                            <h5 class="modal-title">Search Addresses</h5>
                            <button type="button" class="close" data-dismiss="modal">
                                <i class="anticon anticon-close"></i>
                            </button>
                        </div>
                        <div class="modal-body scrollable">
                            <div class="input-affix">
                                <i class="prefix-icon anticon anticon-search"></i>
                                <input type="text" id="txt-search-address" class="form-control"
                                       placeholder="Please put your address here!">
                            </div>
                            <div class="text-center m-5">
                                <button type="button" id="btn-search-address" class="btn btn-primary">Search</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Search End-->

            <!-- Quick View START -->
            <div class="modal modal-right fade quick-view" id="quick-view">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header justify-content-between align-items-center">
                            <h5 class="modal-title">Theme Config</h5>
                        </div>
                        <div class="modal-body scrollable">
                            <div class="m-b-30">
                                <h5 class="m-b-0">Header Color</h5>
                                <p>Config header background color</p>
                                <div class="theme-configurator d-flex m-t-10">
                                    <div class="radio">
                                        <input id="header-default" name="header-theme" type="radio" checked value="default">
                                        <label for="header-default"></label>
                                    </div>
                                    <div class="radio">
                                        <input id="header-primary" name="header-theme" type="radio" value="primary">
                                        <label for="header-primary"></label>
                                    </div>
                                    <div class="radio">
                                        <input id="header-success" name="header-theme" type="radio" value="success">
                                        <label for="header-success"></label>
                                    </div>
                                    <div class="radio">
                                        <input id="header-secondary" name="header-theme" type="radio" value="secondary">
                                        <label for="header-secondary"></label>
                                    </div>
                                    <div class="radio">
                                        <input id="header-danger" name="header-theme" type="radio" value="danger">
                                        <label for="header-danger"></label>
                                    </div>
                                </div>
                            </div>
                            <hr>
                            <div>
                                <h5 class="m-b-0">Side Nav Dark</h5>
                                <p>Change Side Nav to dark</p>
                                <div class="switch d-inline">
                                    <input type="checkbox" name="side-nav-theme-toogle" id="side-nav-theme-toogle">
                                    <label for="side-nav-theme-toogle"></label>
                                </div>
                            </div>
                            <hr>
                            <div>
                                <h5 class="m-b-0">Folded Menu</h5>
                                <p>Toggle Folded Menu</p>
                                <div class="switch d-inline">
                                    <input type="checkbox" name="side-nav-fold-toogle" id="side-nav-fold-toogle">
                                    <label for="side-nav-fold-toogle"></label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Quick View END -->
        </div>
    </div>


    <!-- Core Vendors JS -->
    <script src="../files/assets/js/vendors.min.js"></script>

    <!-- page js -->
    <script src="../files/assets/vendors/chartjs/Chart.min.js"></script>
    {#    <script src="files/assets/js/pages/dashboard-default.js"></script>#}
    {% block custom_js %}
    {% endblock %}
    <!-- Core JS -->
    <script src="../files/assets/js/app.min.js"></script>

    <!-- Custom Js -->
    <script src="../files/assets/js/bootoast.min.js"></script>
    <script>

        $(document).ready(()=>{
            var user_data = checkCookieData('user_data');

            if (user_data !== null)
            {
                // Fill data
                const user_info = JSON.parse(user_data)
                fillUserData(user_info);
            }else{
                window.location.href = '/';
            }

            $("#btn-search-address").on("click" , () => {
                // Redirect to the search result page
                window.location.href = 'address_search_details?address=' + $("#txt-search-address").val();
            });
        });

        /**
         * Delete the Cookie from the list
         * @param cookieName Parameter name to be deleted.
         */
        var deleteCookie = (cookieName) => {
            document.cookie = cookieName + "=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
        };

        /**
         * Check if the cookie name available in the cookie data
         * @param cookieName
         */
        var checkCookieData = (cookieName) => {

            var decodedCookie = decodeURIComponent(document.cookie);
            var cookieArray = decodedCookie.split(';');
            var foundData = null;

            // Iterate through each cookie
            $.each(cookieArray, function(index, cookie) {
                var cookiePair = cookie.trim().split('=');

                // Check if the cookie name matches the provided name
                if (cookiePair[0] === cookieName) {
                    foundData = cookiePair[1];
                    return false; // Exit the loop if the data is found
                }
            });

            return foundData; // Return the found data or null if not found
        };

        /**
         * Setting the cookie value
         * @param cookieName Parameter name
         * @param cookieValue Parameter value
         * @param expirationDays expiration day
         */
        var setCookie = (cookieName, cookieValue, expirationDays) => {
            var date = new Date();
            date.setTime(date.getTime() + (expirationDays * 24 * 60 * 60 * 1000));
            var expires = "expires=" + date.toUTCString();
            document.cookie = cookieName + "=" + encodeURIComponent(JSON.stringify(cookieValue)) + ";" + expires + ";path=/";
        };

        /**
         * Log out the user
         * @param cookieName The user cookie name
         */
        var logOutUser = (cookieName) => {
            deleteCookie(cookieName);
            window.location.href = '/';
        };

        /**
         * User data to fill the user information
         * @param user_data
         */
        var fillUserData = (user_data) => {
            const user_first_last_names = user_data.first_name + ' ' + user_data.last_name;
            $("#user_info_link").text(user_first_last_names);
        };


    </script>


</body>

</html>